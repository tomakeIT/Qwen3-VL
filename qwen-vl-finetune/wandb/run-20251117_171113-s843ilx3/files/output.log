  0%|                                                      | 0/2000 [00:00<?, ?it/s]/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|  | 9/2000 [00:50<3:09:28,  5.71s/it]Traceback (most recent call last):        
{'loss': 3.3341, 'grad_norm': 35.653446197509766, 'learning_rate': 0.0, 'epoch': 1.0}
{'loss': 3.3341, 'grad_norm': 35.49883270263672, 'learning_rate': 3.333333333333333e-09, 'epoch': 2.0}
{'loss': 3.3403, 'grad_norm': 35.34759521484375, 'learning_rate': 6.666666666666666e-09, 'epoch': 3.0}
{'loss': 3.2687, 'grad_norm': 35.25255584716797, 'learning_rate': 1e-08, 'epoch': 4.0}
{'loss': 3.3129, 'grad_norm': 35.544654846191406, 'learning_rate': 1.3333333333333332e-08, 'epoch': 5.0}
{'loss': 3.2915, 'grad_norm': 35.685707092285156, 'learning_rate': 1.6666666666666664e-08, 'epoch': 6.0}
{'loss': 3.3011, 'grad_norm': 35.33155059814453, 'learning_rate': 2e-08, 'epoch': 7.0}
{'loss': 3.3235, 'grad_norm': 35.59773254394531, 'learning_rate': 2.3333333333333334e-08, 'epoch': 8.0}
{'loss': 3.3492, 'grad_norm': 35.442169189453125, 'learning_rate': 2.6666666666666664e-08, 'epoch': 9.0}
  File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
    train(attn_implementation="flash_attention_2")
  File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
    trainer.train()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2618, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 5654, in get_batch_samples
    batch_samples.append(next(epoch_iterator))
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/accelerate/data_loader.py", line 577, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1446, in _next_data
    self._shutdown_workers()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1582, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
[rank0]:     train(attn_implementation="flash_attention_2")
[rank0]:   File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
[rank0]:     trainer.train()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2325, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2618, in _inner_training_loop
[rank0]:     batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 5654, in get_batch_samples
[rank0]:     batch_samples.append(next(epoch_iterator))
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/accelerate/data_loader.py", line 577, in __iter__
[rank0]:     next_batch = next(dataloader_iter)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
[rank0]:     data = self._next_data()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1446, in _next_data
[rank0]:     self._shutdown_workers()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1582, in _shutdown_workers
[rank0]:     w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/process.py", line 149, in join
[rank0]:     res = self._popen.wait(timeout)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
[rank0]:     if not wait([self.sentinel], timeout):
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/connection.py", line 931, in wait
[rank0]:     ready = selector.select(timeout)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/selectors.py", line 416, in select
[rank0]:     fd_event_list = self._selector.poll(timeout)
[rank0]: KeyboardInterrupt
