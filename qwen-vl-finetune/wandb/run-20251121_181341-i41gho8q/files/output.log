  0%|                                                                                                        | 0/2000 [00:00<?, ?it/s]/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                              | 1/2000 [00:15<8:29:51, 15.30s/it]Traceback (most recent call last):
{'loss': 1.1567, 'grad_norm': 53.23813247680664, 'learning_rate': 0.0, 'epoch': 1.0}
  File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
    train(attn_implementation="flash_attention_2")
  File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
    trainer.train()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2618, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 5654, in get_batch_samples
    batch_samples.append(next(epoch_iterator))
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/accelerate/data_loader.py", line 563, in __iter__
    dataloader_iter = self.base_dataloader.__iter__()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 491, in __iter__
    return self._get_iterator()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 422, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1146, in __init__
    w.start()
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/context.py", line 288, in _Popen
    return Popen(process_obj)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_spawn_posix.py", line 32, in __init__
    super().__init__(process_obj)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_spawn_posix.py", line 62, in _launch
    f.write(fp.getbuffer())
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
[rank0]:     train(attn_implementation="flash_attention_2")
[rank0]:   File "/home/erdao/Documents/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
[rank0]:     trainer.train()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2325, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 2618, in _inner_training_loop
[rank0]:     batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/transformers/trainer.py", line 5654, in get_batch_samples
[rank0]:     batch_samples.append(next(epoch_iterator))
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/accelerate/data_loader.py", line 563, in __iter__
[rank0]:     dataloader_iter = self.base_dataloader.__iter__()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 491, in __iter__
[rank0]:     return self._get_iterator()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 422, in _get_iterator
[rank0]:     return _MultiProcessingDataLoaderIter(self)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1146, in __init__
[rank0]:     w.start()
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/process.py", line 121, in start
[rank0]:     self._popen = self._Popen(self)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
[rank0]:     return _default_context.get_context().Process._Popen(process_obj)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/context.py", line 288, in _Popen
[rank0]:     return Popen(process_obj)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_spawn_posix.py", line 32, in __init__
[rank0]:     super().__init__(process_obj)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
[rank0]:     self._launch(process_obj)
[rank0]:   File "/home/erdao/miniconda3/envs/qwen-train/lib/python3.10/multiprocessing/popen_spawn_posix.py", line 62, in _launch
[rank0]:     f.write(fp.getbuffer())
[rank0]: KeyboardInterrupt
